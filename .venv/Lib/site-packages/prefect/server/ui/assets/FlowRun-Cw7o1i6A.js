import{d as B,S as P,ae as _,g as r,n as S,o as u,l as m,c as i,a as f,k as a,m as l,bm as z,bn as q,bo as D,bp as G,bq as N,br as $,bs as A,aw as L,e as J,v as K,bt as M,ah as h,bu as Q,al as H,bv as W,bw as X,bx as Y,by as Z,bz as ee,bg as x,h as k,i as o,a6 as le,bA as U,bB as te,bC as se,bD as ne,bE as ae,bF as oe,bG as ue}from"./index-B0cSqUYc.js";import{u as re}from"./usePageTitle-CARQDM5z.js";const ie={class:"flow-run-graphs__graph-panel-container"},fe={class:"flow-run-graphs__graphs"},ce={class:"flow-run-graphs__panel p-background"},pe=B({__name:"FlowRunGraphs",props:{flowRun:{}},setup(F){const v=P(),d=_(),n=_(!1),e=_(null),w=r(()=>({root:{"flow-run-graphs--fullscreen":n.value,"flow-run-graphs--show-panel":e.value?.kind==="task-run"||e.value?.kind==="flow-run"}})),c=async({nodeId:p,since:s,until:t})=>{const b={anyResource:{id:[`prefect.flow-run.${p}`]},event:{excludePrefix:["prefect.log.write","prefect.task-run."]},occurred:{since:s,until:t}},{events:g}=await v.events.getEvents(b);return g};return(p,s)=>(u(),S("div",{class:L(["flow-run-graphs",w.value.root])},[m("div",ie,[m("div",fe,[a(l(z),{fullscreen:n.value,"onUpdate:fullscreen":s[0]||(s[0]=t=>n.value=t),viewport:d.value,"onUpdate:viewport":s[1]||(s[1]=t=>d.value=t),selected:e.value,"onUpdate:selected":s[2]||(s[2]=t=>e.value=t),"flow-run":p.flowRun,"fetch-events":c,class:"flow-run-graphs__flow-run"},null,8,["fullscreen","viewport","selected","flow-run"])]),m("div",ce,[e.value?.kind==="task-run"||e.value?.kind==="flow-run"?(u(),i(l(q),{key:0,selection:e.value,"onUpdate:selection":s[3]||(s[3]=t=>e.value=t),floating:n.value},null,8,["selection","floating"])):f("",!0)])]),e.value&&e.value.kind==="event"?(u(),i(l(D),{key:0,selection:e.value,"onUpdate:selection":s[4]||(s[4]=t=>e.value=t)},null,8,["selection"])):f("",!0),e.value&&e.value.kind==="events"?(u(),i(l(G),{key:1,selection:e.value,"onUpdate:selection":s[5]||(s[5]=t=>e.value=t)},null,8,["selection"])):f("",!0),e.value&&e.value.kind==="artifacts"?(u(),i(l(N),{key:2,selection:e.value,"onUpdate:selection":s[6]||(s[6]=t=>e.value=t)},null,8,["selection"])):f("",!0),e.value?.kind==="state"?(u(),i(l($),{key:3,selection:e.value,"onUpdate:selection":s[7]||(s[7]=t=>e.value=t)},null,8,["selection"])):f("",!0),a(l(A),{selection:e.value,"onUpdate:selection":s[8]||(s[8]=t=>e.value=t)},null,8,["selection"])],2))}}),we=B({__name:"FlowRun",setup(F){const v=J(),d=K("flowRunId"),{flowRun:n,subscription:e}=M(d,{interval:5e3}),w=r(()=>h(n.value?.parameters??{})),c=r(()=>n.value?.stateType?Q(n.value.stateType):!0),p=r(()=>h(n.value?.jobVariables??{})),s=r(()=>[{label:"Logs"},{label:"Task Runs",hidden:c.value},{label:"Subflow Runs",hidden:c.value},{label:"Artifacts",hidden:c.value},{label:"Details"},{label:"Parameters"},{label:"Job Variables"}]),t=H("tab","Logs"),{tabs:b}=W(s,t),g=r(()=>[d.value]),{filter:O}=X({flowRuns:{parentFlowRunId:g}});function I(){v.push(x.runs())}Y(n);const T=r(()=>n.value?`Flow Run: ${n.value.name}`:"Flow Run");return re(T),Z(()=>{e.error&&ee(e.error).isInRange("clientError")&&v.replace(x[404]())}),(j,R)=>{const y=k("p-code-highlight"),C=k("p-tabs"),E=k("p-layout-default");return l(n)?(u(),i(E,{key:l(n).id,class:"flow-run"},{header:o(()=>[a(l(ue),{"flow-run-id":l(n).id,onDelete:I},null,8,["flow-run-id"])]),default:o(()=>[c.value?f("",!0):(u(),i(pe,{key:0,"flow-run":l(n)},null,8,["flow-run"])),a(C,{selected:l(t),"onUpdate:selected":R[0]||(R[0]=V=>le(t)?t.value=V:null),tabs:l(b)},{details:o(()=>[a(l(oe),{"flow-run":l(n)},null,8,["flow-run"])]),logs:o(()=>[a(l(ae),{"flow-run":l(n)},null,8,["flow-run"])]),artifacts:o(()=>[a(l(ne),{"flow-run":l(n)},null,8,["flow-run"])]),"task-runs":o(()=>[a(l(se),{"flow-run-id":l(n).id},null,8,["flow-run-id"])]),"subflow-runs":o(()=>[a(l(te),{filter:l(O)},null,8,["filter"])]),parameters:o(()=>[a(l(U),{"text-to-copy":w.value},{default:o(()=>[a(y,{lang:"json",text:w.value,class:"flow-run__parameters"},null,8,["text"])]),_:1},8,["text-to-copy"])]),"job-variables":o(()=>[a(l(U),{"text-to-copy":p.value},{default:o(()=>[a(y,{lang:"json",text:p.value,class:"flow-run__job-variables"},null,8,["text"])]),_:1},8,["text-to-copy"])]),_:1},8,["selected","tabs"])]),_:1})):f("",!0)}}});export{we as default};
//# sourceMappingURL=FlowRun-Cw7o1i6A.js.map
