{"version":3,"file":"Deployment-BRu6eqPg.js","sources":["../../src/pages/Deployment.vue"],"sourcesContent":["<template>\n  <p-layout-well v-if=\"deployment\" class=\"deployment\">\n    <template #header>\n      <PageHeadingDeployment\n        :deployment=\"deployment\"\n        @update=\"deploymentSubscription.refresh\"\n        @delete=\"routeToDeployments\"\n      />\n    </template>\n\n\n    <p-tabs v-model:selected=\"tab\" :tabs=\"tabs\">\n      <template #description>\n        <p-content secondary>\n          <DeploymentDeprecatedMessage v-if=\"deployment.deprecated\" />\n          <template v-else-if=\"deployment.description\">\n            <DeploymentDescription :description=\"deployment.description\" />\n          </template>\n          <template v-else>\n            <DeploymentDescriptionEmptyState :deployment=\"deployment\" />\n          </template>\n        </p-content>\n      </template>\n\n      <template #parameters>\n        <ParametersTable :deployment=\"deployment\" />\n      </template>\n\n      <template #configuration>\n        <DeploymentConfiguration :deployment=\"deployment\" />\n      </template>\n\n      <template #details>\n        <DeploymentDetails :deployment=\"deployment\" @update=\"deploymentSubscription.refresh\" />\n      </template>\n\n      <template #runs>\n        <template v-if=\"nextRun\">\n          <p-heading heading=\"6\" class=\"deployment__next-run\">\n            Next Run\n          </p-heading>\n          <FlowRunListItem :flow-run=\"nextRun\" />\n          <p-divider />\n        </template>\n        <FlowRunFilteredList :filter=\"flowRunsFilter\" selectable prefix=\"runs\" />\n      </template>\n\n      <template #upcoming>\n        <FlowRunFilteredList :filter=\"upcomingFlowRunsFilter\" selectable prefix=\"upcoming\" />\n      </template>\n    </p-tabs>\n\n    <template #well>\n      <DeploymentDetails :deployment=\"deployment\" alternate @update=\"deploymentSubscription.refresh\" />\n    </template>\n  </p-layout-well>\n</template>\n\n<script lang=\"ts\" setup>\n  import { media } from '@prefecthq/prefect-design'\n  import { DeploymentDescription, FlowRunListItem, DeploymentDetails, DeploymentDescriptionEmptyState, PageHeadingDeployment, ParametersTable, DeploymentDeprecatedMessage, useTabs, useWorkspaceApi, useFlowRunsFilter, prefectStateNames, DeploymentConfiguration, useNextFlowRun, FlowRunFilteredList } from '@prefecthq/prefect-ui-library'\n  import { useRouteParam, useRouteQueryParam, useSubscription } from '@prefecthq/vue-compositions'\n  import { computed } from 'vue'\n  import { useRouter } from 'vue-router'\n  import { usePageTitle } from '@/compositions/usePageTitle'\n  import { routes } from '@/router'\n\n\n  const deploymentId = useRouteParam('deploymentId')\n  const deploymentIds = computed(() => [deploymentId.value])\n  const router = useRouter()\n  const api = useWorkspaceApi()\n\n  const subscriptionOptions = {\n    interval: 300000,\n  }\n\n  const deploymentSubscription = useSubscription(api.deployments.getDeployment, [deploymentId.value], subscriptionOptions)\n  const deployment = computed(() => deploymentSubscription.response)\n\n  const computedTabs = computed(() => [\n    { label: 'Details', hidden: media.xl },\n    { label: 'Runs' },\n    { label: 'Upcoming' },\n    { label: 'Parameters', hidden: deployment.value?.deprecated },\n    { label: 'Configuration', hidden: deployment.value?.deprecated },\n    { label: 'Description' },\n  ])\n  const tab = useRouteQueryParam('tab', 'Details')\n  const { tabs } = useTabs(computedTabs, tab)\n\n  function routeToDeployments(): void {\n    router.push(routes.deployments())\n  }\n\n  const { filter: flowRunsFilter } = useFlowRunsFilter({\n    deployments: {\n      id: deploymentIds,\n    },\n    flowRuns: {\n      state: {\n        name: prefectStateNames.filter(stateName => stateName !== 'Scheduled'),\n      },\n    },\n  })\n\n  const { filter: upcomingFlowRunsFilter } = useFlowRunsFilter({\n    sort: 'START_TIME_ASC',\n    deployments: {\n      id: deploymentIds,\n    },\n    flowRuns: {\n      state: {\n        name: ['Scheduled'],\n      },\n    },\n  })\n\n  const { flowRun: nextRun } = useNextFlowRun(() => ({\n    deployments: {\n      id: deploymentIds.value,\n    },\n  }))\n\n\n  const title = computed(() => {\n    if (!deployment.value) {\n      return 'Deployment'\n    }\n    return `Deployment: ${deployment.value.name}`\n  })\n  usePageTitle(title)\n</script>\n\n<style>\n.deployment__next-run { @apply\n  mb-2\n}\n</style>"],"names":["deploymentId","useRouteParam","deploymentIds","computed","router","useRouter","api","useWorkspaceApi","subscriptionOptions","deploymentSubscription","useSubscription","deployment","computedTabs","media","tab","useRouteQueryParam","tabs","useTabs","routeToDeployments","routes","flowRunsFilter","useFlowRunsFilter","prefectStateNames","stateName","upcomingFlowRunsFilter","nextRun","useNextFlowRun","title","usePageTitle","_createBlock","_component_p_layout_well","_createVNode","_unref","PageHeadingDeployment","DeploymentDetails","_component_p_tabs","$event","_component_p_content","DeploymentDeprecatedMessage","DeploymentDescription","DeploymentDescriptionEmptyState","ParametersTable","DeploymentConfiguration","_createElementBlock","_Fragment","_component_p_heading","_cache","FlowRunListItem","_component_p_divider","FlowRunFilteredList"],"mappings":"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"}